{"version":3,"sources":["behaviour_test.js"],"names":[],"mappings":"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","file":"behaviour_test-compiled.js","sourcesContent":["/* ***** BEGIN LICENSE BLOCK *****\n * Distributed under the BSD license:\n *\n * Copyright (c) 2010, Ajax.org B.V.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *     * Redistributions of source code must retain the above copyright\n *       notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above copyright\n *       notice, this list of conditions and the following disclaimer in the\n *       documentation and/or other materials provided with the distribution.\n *     * Neither the name of Ajax.org B.V. nor the\n *       names of its contributors may be used to endorse or promote products\n *       derived from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * ***** END LICENSE BLOCK ***** */\n\nif (typeof process !== \"undefined\") {\n    require(\"amd-loader\");\n    require(\"../../test/mockdom\");\n}\n\ndefine(function(require, exports, module) {\n\"use strict\";\n\nrequire(\"../../multi_select\");\nvar assert = require(\"../../test/assertions\");\nvar Range = require(\"../../range\").Range;\nvar Editor = require(\"../../editor\").Editor;\nvar EditSession = require(\"../../edit_session\").EditSession;\nvar MockRenderer = require(\"../../test/mockrenderer\").MockRenderer;\nvar JavaScriptMode = require(\"../javascript\").Mode;\nvar XMLMode = require(\"../xml\").Mode;\nvar editor;\nvar exec = function(name, times, args) {\n    do {\n        editor.commands.exec(name, editor, args);\n    } while(times --> 1);\n};\nvar testRanges = function(str) {\n    assert.equal(editor.selection.getAllRanges() + \"\", str + \"\");\n};\n\nmodule.exports = {\n    \"test: cstyle\": function() {\n        function testValue(line) {\n            assert.equal(editor.getValue(), Array(4).join(line + \"\\n\"));\n        }\n        function testSelection(line, col, inc) {\n            editor.selection.rangeList.ranges.forEach(function(r) {\n                assert.range(r, line, col, line, col);\n                line += (inc || 1);\n            });\n        }\n        var doc = new EditSession([\n            \"\",\n            \"\",\n            \"\",\n            \"\"\n        ], new JavaScriptMode());\n        editor = new Editor(new MockRenderer(), doc);\n        editor.setOption(\"behavioursEnabled\", true);\n\n        editor.navigateFileStart();\n        exec(\"addCursorBelow\", 2);\n\n        exec(\"insertstring\", 1, \"if \");\n        \n        // pairing ( \n        exec(\"insertstring\", 1, \"(\");\n        testValue(\"if ()\");\n        testSelection(0, 4);\n        exec(\"insertstring\", 1, \")\");\n        testValue(\"if ()\");\n        testSelection(0, 5);\n        \n        // pairing [ \n        exec(\"gotoleft\", 1);\n        exec(\"insertstring\", 1, \"[\");\n        testValue(\"if ([])\");\n        testSelection(0, 5);\n        \n        exec(\"insertstring\", 1, \"]\");\n        testValue(\"if ([])\");\n        testSelection(0, 6);\n        \n        // test deletion\n        exec(\"gotoleft\", 1);\n        exec(\"backspace\", 1);\n        testValue(\"if ()\");\n        testSelection(0, 4);\n\n        exec(\"gotolineend\", 1);\n        exec(\"insertstring\", 1, \"{\");\n        testValue(\"if (){}\");\n        testSelection(0, 6);\n        \n        exec(\"insertstring\", 1, \"}\");\n        testValue(\"if (){}\");\n        testSelection(0, 7);\n        \n        exec(\"gotolinestart\", 1);\n        exec(\"insertstring\", 1, \"(\");\n        testValue(\"(if (){}\");\n        exec(\"backspace\", 1);\n        \n        editor.setValue(\"\");\n        exec(\"insertstring\", 1, \"{\");\n        assert.equal(editor.getValue(), \"{\");\n        exec(\"insertstring\", 1, \"\\n\");\n        assert.equal(editor.getValue(), \"{\\n    \\n}\");\n        \n        editor.setValue(\"\");\n        exec(\"insertstring\", 1, \"(\");\n        exec(\"insertstring\", 1, '\"');\n        exec(\"insertstring\", 1, '\"');\n        assert.equal(editor.getValue(), '(\"\")');\n        exec(\"backspace\", 1);\n        exec(\"insertstring\", 1, '\"');\n        assert.equal(editor.getValue(), '(\"\")');\n        \n        editor.setValue(\"('foo')\", 1);\n        exec(\"gotoleft\", 1);\n        exec(\"selectleft\", 1);\n        exec(\"selectMoreBefore\", 1);\n        exec(\"insertstring\", 1, \"'\");\n        assert.equal(editor.getValue(), \"('foo')\");\n        exec(\"selectleft\", 1);\n        exec(\"insertstring\", 1, '\"');\n        assert.equal(editor.getValue(), '(\"foo\")');\n        exec(\"selectleft\", 1);\n        exec(\"insertstring\", 1, '\"');\n        assert.equal(editor.getValue(), '(\"foo\")');\n        \n        editor.setValue(\"\", 1);\n        exec(\"selectleft\", 1);\n        exec(\"insertstring\", 1, '\"');\n        assert.equal(editor.getValue(), '\"\"');\n        exec(\"insertstring\", 1, '\\\\');\n        exec(\"insertstring\", 1, 'n');\n        exec(\"insertstring\", 1, '\"');\n        assert.equal(editor.getValue(), '\"\\\\n\"');\n        \n    },\n    \"test: xml\": function() {\n        editor = new Editor(new MockRenderer());\n        editor.setValue([\"<OuterTag>\",\n            \"    <SelfClosingTag />\"\n        ].join(\"\\n\"));\n        editor.session.setMode(new XMLMode);\n        exec(\"golinedown\", 1);\n        exec(\"gotolineend\", 1);\n        exec(\"insertstring\", 1, '\\n');\n        assert.equal(editor.session.getLine(2), \"    \");\n        exec(\"gotolineup\", 1);\n        exec(\"gotolineend\", 1);\n        exec(\"insertstring\", 1, '\\n');\n        assert.equal(editor.session.getLine(2), \"    \");\n        editor.session.setValue([\"<OuterTag\",\n            \"    <xyzrt\"\n        ].join(\"\\n\"));        \n        exec(\"golinedown\", 1);\n        exec(\"gotolineend\", 1);\n        exec(\"selectleft\", 3);\n        exec(\"insertstring\", 1, '>');\n        assert.equal(editor.session.getLine(1), \"    <xy></xy>\");\n    }\n};\n\n});\n\nif (typeof module !== \"undefined\" && module === require.main) {\n    require(\"asyncjs\").test.testcase(module.exports).exec();\n}\n"]}
{"version":3,"sources":["sax.js"],"names":[],"mappings":"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","file":"sax-compiled.js","sourcesContent":["define(function(require, exports, module) {\n\n//[4]   \tNameStartChar\t   ::=   \t\":\" | [A-Z] | \"_\" | [a-z] | [#xC0-#xD6] | [#xD8-#xF6] | [#xF8-#x2FF] | [#x370-#x37D] | [#x37F-#x1FFF] | [#x200C-#x200D] | [#x2070-#x218F] | [#x2C00-#x2FEF] | [#x3001-#xD7FF] | [#xF900-#xFDCF] | [#xFDF0-#xFFFD] | [#x10000-#xEFFFF]\n//[4a]   \tNameChar\t   ::=   \tNameStartChar | \"-\" | \".\" | [0-9] | #xB7 | [#x0300-#x036F] | [#x203F-#x2040]\n//[5]   \tName\t   ::=   \tNameStartChar (NameChar)*\nvar nameStartChar = /[A-Z_a-z\\xC0-\\xD6\\xD8-\\xF6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD]///\\u10000-\\uEFFFF\nvar nameChar = new RegExp(\"[\\\\-\\\\.0-9\"+nameStartChar.source.slice(1,-1)+\"\\u00B7\\u0300-\\u036F\\\\ux203F-\\u2040]\");\nvar tagNamePattern = new RegExp('^'+nameStartChar.source+nameChar.source+'*(?:\\:'+nameStartChar.source+nameChar.source+'*)?$');\n//var tagNamePattern = /^[a-zA-Z_][\\w\\-\\.]*(?:\\:[a-zA-Z_][\\w\\-\\.]*)?$/\n//var handlers = 'resolveEntity,getExternalSubset,characters,endDocument,endElement,endPrefixMapping,ignorableWhitespace,processingInstruction,setDocumentLocator,skippedEntity,startDocument,startElement,startPrefixMapping,notationDecl,unparsedEntityDecl,error,fatalError,warning,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,comment,endCDATA,endDTD,endEntity,startCDATA,startDTD,startEntity'.split(',')\n\n//S_TAG,\tS_ATTR,\tS_EQ,\tS_V\n//S_ATTR_S,\tS_E,\tS_S,\tS_C\nvar S_TAG = 0;//tag name offerring\nvar S_ATTR = 1;//attr name offerring \nvar S_ATTR_S=2;//attr name end and space offer\nvar S_EQ = 3;//=space?\nvar S_V = 4;//attr value(no quot value only)\nvar S_E = 5;//attr value end and no space(quot end)\nvar S_S = 6;//(attr value end || tag end ) && (space offer)\nvar S_C = 7;//closed el<el />\n\nfunction XMLReader(){\n\t\n}\n\nXMLReader.prototype = {\n\tparse:function(source,defaultNSMap,entityMap){\n\t\tvar domBuilder = this.domBuilder;\n\t\tdomBuilder.startDocument();\n\t\t_copy(defaultNSMap ,defaultNSMap = {})\n\t\tparse(source,defaultNSMap,entityMap,\n\t\t\t\tdomBuilder,this.errorHandler);\n\t\tdomBuilder.endDocument();\n\t}\n}\nfunction parse(source,defaultNSMapCopy,entityMap,domBuilder,errorHandler){\n  function fixedFromCharCode(code) {\n\t\t// String.prototype.fromCharCode does not supports\n\t\t// > 2 bytes unicode chars directly\n\t\tif (code > 0xffff) {\n\t\t\tcode -= 0x10000;\n\t\t\tvar surrogate1 = 0xd800 + (code >> 10)\n\t\t\t\t, surrogate2 = 0xdc00 + (code & 0x3ff);\n\n\t\t\treturn String.fromCharCode(surrogate1, surrogate2);\n\t\t} else {\n\t\t\treturn String.fromCharCode(code);\n\t\t}\n\t}\n\tfunction entityReplacer(a){\n\t\tvar k = a.slice(1,-1);\n\t\tif(k in entityMap){\n\t\t\treturn entityMap[k]; \n\t\t}else if(k.charAt(0) === '#'){\n\t\t\treturn fixedFromCharCode(parseInt(k.substr(1).replace('x','0x')))\n\t\t}else{\n\t\t\terrorHandler.error('entity not found:'+a);\n\t\t\treturn a;\n\t\t}\n\t}\n\tfunction appendText(end){//has some bugs\n\t\tvar xt = source.substring(start,end).replace(/&#?\\w+;/g,entityReplacer);\n\t\tlocator&&position(start);\n\t\tdomBuilder.characters(xt,0,end-start);\n\t\tstart = end\n\t}\n\tfunction position(start,m){\n\t\twhile(start>=endPos && (m = linePattern.exec(source))){\n\t\t\tstartPos = m.index;\n\t\t\tendPos = startPos + m[0].length;\n\t\t\tlocator.lineNumber++;\n\t\t\t//console.log('line++:',locator,startPos,endPos)\n\t\t}\n\t\tlocator.columnNumber = start-startPos+1;\n\t}\n\tvar startPos = 0;\n\tvar endPos = 0;\n\tvar linePattern = /.+(?:\\r\\n?|\\n)|.*$/g\n\tvar locator = domBuilder.locator;\n\t\n\tvar parseStack = [{currentNSMap:defaultNSMapCopy}]\n\tvar closeMap = {};\n\tvar start = 0;\n\twhile(true){\n\t\tvar i = source.indexOf('<',start);\n\t\tif(i<0){\n\t\t\tif(!source.substr(start).match(/^\\s*$/)){\n\t\t\t\tvar doc = domBuilder.document;\n    \t\t\tvar text = doc.createTextNode(source.substr(start));\n    \t\t\tdoc.appendChild(text);\n    \t\t\tdomBuilder.currentElement = text;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif(i>start){\n\t\t\tappendText(i);\n\t\t}\n\t\tswitch(source.charAt(i+1)){\n\t\tcase '/':\n\t\t\tvar end = source.indexOf('>',i+3);\n\t\t\tvar tagName = source.substring(i+2,end);\n\t\t\tvar config;\n\t\t\tif (parseStack.length > 1) {\n\t\t\t\tconfig = parseStack.pop();\n\t\t\t} else {\n\t\t\t\terrorHandler.fatalError(\"end tag name not found for: \"+tagName);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar localNSMap = config.localNSMap;\n\t\t\t\n\t        if(config.tagName != tagName){\n\t            errorHandler.fatalError(\"end tag name: \" + tagName + \" does not match the current start tagName: \"+config.tagName );\n\t        }\n\t\t\tdomBuilder.endElement(config.uri,config.localName,tagName);\n\t\t\tif(localNSMap){\n\t\t\t\tfor(var prefix in localNSMap){\n\t\t\t\t\tdomBuilder.endPrefixMapping(prefix) ;\n\t\t\t\t}\n\t\t\t}\n\t\t\tend++;\n\t\t\tbreak;\n\t\t\t// end elment\n\t\tcase '?':// <?...?>\n\t\t\tlocator&&position(i);\n\t\t\tend = parseInstruction(source,i,domBuilder);\n\t\t\tbreak;\n\t\tcase '!':// <!doctype,<![CDATA,<!--\n\t\t\tlocator&&position(i);\n\t\t\tend = parseDCC(source,i,domBuilder,errorHandler);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\ttry{\n\t\t\t\tlocator&&position(i);\n\t\t\t\t\n\t\t\t\tvar el = new ElementAttributes();\n\t\t\t\t\n\t\t\t\t//elStartEnd\n\t\t\t\tvar end = parseElementStartPart(source,i,el,entityReplacer,errorHandler);\n\t\t\t\tvar len = el.length;\n\t\t\t\t//position fixed\n\t\t\t\tif(len && locator){\n\t\t\t\t\tvar backup = copyLocator(locator,{});\n\t\t\t\t\tfor(var i = 0;i<len;i++){\n\t\t\t\t\t\tvar a = el[i];\n\t\t\t\t\t\tposition(a.offset);\n\t\t\t\t\t\ta.offset = copyLocator(locator,{});\n\t\t\t\t\t}\n\t\t\t\t\tcopyLocator(backup,locator);\n\t\t\t\t}\n\t\t\t\tif(!el.closed && fixSelfClosed(source,end,el.tagName,closeMap)){\n\t\t\t\t\tel.closed = true;\n\t\t\t\t\tif(!entityMap.nbsp){\n\t\t\t\t\t\terrorHandler.warning('unclosed xml attribute');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tappendElement(el,domBuilder,parseStack);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tif(el.uri === 'http://www.w3.org/1999/xhtml' && !el.closed){\n\t\t\t\t\tend = parseHtmlSpecialContent(source,end,el.tagName,entityReplacer,domBuilder)\n\t\t\t\t}else{\n\t\t\t\t\tend++;\n\t\t\t\t}\n\t\t\t}catch(e){\n\t\t\t\terrorHandler.error('element parse error: '+e);\n\t\t\t\tend = -1;\n\t\t\t}\n\n\t\t}\n\t\tif(end<0){\n\t\t\t//TODO: 这里有可能sax回退，有位置错误风险\n\t\t\tappendText(i+1);\n\t\t}else{\n\t\t\tstart = end;\n\t\t}\n\t}\n}\nfunction copyLocator(f,t){\n\tt.lineNumber = f.lineNumber;\n\tt.columnNumber = f.columnNumber;\n\treturn t;\n\t\n}\n\n/**\n * @see #appendElement(source,elStartEnd,el,selfClosed,entityReplacer,domBuilder,parseStack);\n * @return end of the elementStartPart(end of elementEndPart for selfClosed el)\n */\nfunction parseElementStartPart(source,start,el,entityReplacer,errorHandler){\n\tvar attrName;\n\tvar value;\n\tvar p = ++start;\n\tvar s = S_TAG;//status\n\twhile(true){\n\t\tvar c = source.charAt(p);\n\t\tswitch(c){\n\t\tcase '=':\n\t\t\tif(s === S_ATTR){//attrName\n\t\t\t\tattrName = source.slice(start,p);\n\t\t\t\ts = S_EQ;\n\t\t\t}else if(s === S_ATTR_S){\n\t\t\t\ts = S_EQ;\n\t\t\t}else{\n\t\t\t\t//fatalError: equal must after attrName or space after attrName\n\t\t\t\tthrow new Error('attribute equal must after attrName');\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '\\'':\n\t\tcase '\"':\n\t\t\tif(s === S_EQ){//equal\n\t\t\t\tstart = p+1;\n\t\t\t\tp = source.indexOf(c,start)\n\t\t\t\tif(p>0){\n\t\t\t\t\tvalue = source.slice(start,p).replace(/&#?\\w+;/g,entityReplacer);\n\t\t\t\t\tel.add(attrName,value,start-1);\n\t\t\t\t\ts = S_E;\n\t\t\t\t}else{\n\t\t\t\t\t//fatalError: no end quot match\n\t\t\t\t\tthrow new Error('attribute value no end \\''+c+'\\' match');\n\t\t\t\t}\n\t\t\t}else if(s == S_V){\n\t\t\t\tvalue = source.slice(start,p).replace(/&#?\\w+;/g,entityReplacer);\n\t\t\t\t//console.log(attrName,value,start,p)\n\t\t\t\tel.add(attrName,value,start);\n\t\t\t\t//console.dir(el)\n\t\t\t\terrorHandler.warning('attribute \"'+attrName+'\" missed start quot('+c+')!!');\n\t\t\t\tstart = p+1;\n\t\t\t\ts = S_E\n\t\t\t}else{\n\t\t\t\t//fatalError: no equal before\n\t\t\t\tthrow new Error('attribute value must after \"=\"');\n\t\t\t}\n\t\t\tbreak;\n\t\tcase '/':\n\t\t\tswitch(s){\n\t\t\tcase S_TAG:\n\t\t\t\tel.setTagName(source.slice(start,p));\n\t\t\tcase S_E:\n\t\t\tcase S_S:\n\t\t\tcase S_C:\n\t\t\t\ts = S_C;\n\t\t\t\tel.closed = true;\n\t\t\tcase S_V:\n\t\t\tcase S_ATTR:\n\t\t\tcase S_ATTR_S:\n\t\t\t\tbreak;\n\t\t\t//case S_EQ:\n\t\t\tdefault:\n\t\t\t\tthrow new Error(\"attribute invalid close char('/')\")\n\t\t\t}\n\t\t\tbreak;\n\t\tcase ''://end document\n\t\t\t//throw new Error('unexpected end of input')\n\t\t\terrorHandler.error('unexpected end of input');\n\t\tcase '>':\n\t\t\tswitch(s){\n\t\t\tcase S_TAG:\n\t\t\t\tel.setTagName(source.slice(start,p));\n\t\t\tcase S_E:\n\t\t\tcase S_S:\n\t\t\tcase S_C:\n\t\t\t\tbreak;//normal\n\t\t\tcase S_V://Compatible state\n\t\t\tcase S_ATTR:\n\t\t\t\tvalue = source.slice(start,p);\n\t\t\t\tif(value.slice(-1) === '/'){\n\t\t\t\t\tel.closed  = true;\n\t\t\t\t\tvalue = value.slice(0,-1)\n\t\t\t\t}\n\t\t\tcase S_ATTR_S:\n\t\t\t\tif(s === S_ATTR_S){\n\t\t\t\t\tvalue = attrName;\n\t\t\t\t}\n\t\t\t\tif(s == S_V){\n\t\t\t\t\terrorHandler.warning('attribute \"'+value+'\" missed quot(\")!!');\n\t\t\t\t\tel.add(attrName,value.replace(/&#?\\w+;/g,entityReplacer),start)\n\t\t\t\t}else{\n\t\t\t\t\terrorHandler.warning('attribute \"'+value+'\" missed value!! \"'+value+'\" instead!!')\n\t\t\t\t\tel.add(value,value,start)\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase S_EQ:\n\t\t\t\tthrow new Error('attribute value missed!!');\n\t\t\t}\n//\t\t\tconsole.log(tagName,tagNamePattern,tagNamePattern.test(tagName))\n\t\t\treturn p;\n\t\t/*xml space '\\x20' | #x9 | #xD | #xA; */\n\t\tcase '\\u0080':\n\t\t\tc = ' ';\n\t\tdefault:\n\t\t\tif(c<= ' '){//space\n\t\t\t\tswitch(s){\n\t\t\t\tcase S_TAG:\n\t\t\t\t\tel.setTagName(source.slice(start,p));//tagName\n\t\t\t\t\ts = S_S;\n\t\t\t\t\tbreak;\n\t\t\t\tcase S_ATTR:\n\t\t\t\t\tattrName = source.slice(start,p)\n\t\t\t\t\ts = S_ATTR_S;\n\t\t\t\t\tbreak;\n\t\t\t\tcase S_V:\n\t\t\t\t\tvar value = source.slice(start,p).replace(/&#?\\w+;/g,entityReplacer);\n\t\t\t\t\terrorHandler.warning('attribute \"'+value+'\" missed quot(\")!!');\n\t\t\t\t\tel.add(attrName,value,start)\n\t\t\t\tcase S_E:\n\t\t\t\t\ts = S_S;\n\t\t\t\t\tbreak;\n\t\t\t\t//case S_S:\n\t\t\t\t//case S_EQ:\n\t\t\t\t//case S_ATTR_S:\n\t\t\t\t//\tvoid();break;\n\t\t\t\t//case S_C:\n\t\t\t\t\t//ignore warning\n\t\t\t\t}\n\t\t\t}else{//not space\n//S_TAG,\tS_ATTR,\tS_EQ,\tS_V\n//S_ATTR_S,\tS_E,\tS_S,\tS_C\n\t\t\t\tswitch(s){\n\t\t\t\t//case S_TAG:void();break;\n\t\t\t\t//case S_ATTR:void();break;\n\t\t\t\t//case S_V:void();break;\n\t\t\t\tcase S_ATTR_S:\n\t\t\t\t\terrorHandler.warning('attribute \"'+attrName+'\" missed value!! \"'+attrName+'\" instead!!')\n\t\t\t\t\tel.add(attrName,attrName,start);\n\t\t\t\t\tstart = p;\n\t\t\t\t\ts = S_ATTR;\n\t\t\t\t\tbreak;\n\t\t\t\tcase S_E:\n\t\t\t\t\terrorHandler.warning('attribute space is required\"'+attrName+'\"!!')\n\t\t\t\tcase S_S:\n\t\t\t\t\ts = S_ATTR;\n\t\t\t\t\tstart = p;\n\t\t\t\t\tbreak;\n\t\t\t\tcase S_EQ:\n\t\t\t\t\ts = S_V;\n\t\t\t\t\tstart = p;\n\t\t\t\t\tbreak;\n\t\t\t\tcase S_C:\n\t\t\t\t\tthrow new Error(\"elements closed character '/' and '>' must be connected to\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tp++;\n\t}\n}\n/**\n * @return end of the elementStartPart(end of elementEndPart for selfClosed el)\n */\nfunction appendElement(el,domBuilder,parseStack){\n\tvar tagName = el.tagName;\n\tvar localNSMap = null;\n\tvar currentNSMap = parseStack[parseStack.length-1].currentNSMap;\n\tvar i = el.length;\n\twhile(i--){\n\t\tvar a = el[i];\n\t\tvar qName = a.qName;\n\t\tvar value = a.value;\n\t\tvar nsp = qName.indexOf(':');\n\t\tif(nsp>0){\n\t\t\tvar prefix = a.prefix = qName.slice(0,nsp);\n\t\t\tvar localName = qName.slice(nsp+1);\n\t\t\tvar nsPrefix = prefix === 'xmlns' && localName\n\t\t}else{\n\t\t\tlocalName = qName;\n\t\t\tprefix = null\n\t\t\tnsPrefix = qName === 'xmlns' && ''\n\t\t}\n\t\t//can not set prefix,because prefix !== ''\n\t\ta.localName = localName ;\n\t\t//prefix == null for no ns prefix attribute \n\t\tif(nsPrefix !== false){//hack!!\n\t\t\tif(localNSMap == null){\n\t\t\t\tlocalNSMap = {}\n\t\t\t\t//console.log(currentNSMap,0)\n\t\t\t\t_copy(currentNSMap,currentNSMap={})\n\t\t\t\t//console.log(currentNSMap,1)\n\t\t\t}\n\t\t\tcurrentNSMap[nsPrefix] = localNSMap[nsPrefix] = value;\n\t\t\ta.uri = 'http://www.w3.org/2000/xmlns/'\n\t\t\tdomBuilder.startPrefixMapping(nsPrefix, value) \n\t\t}\n\t}\n\tvar i = el.length;\n\twhile(i--){\n\t\ta = el[i];\n\t\tvar prefix = a.prefix;\n\t\tif(prefix){//no prefix attribute has no namespace\n\t\t\tif(prefix === 'xml'){\n\t\t\t\ta.uri = 'http://www.w3.org/XML/1998/namespace';\n\t\t\t}if(prefix !== 'xmlns'){\n\t\t\t\ta.uri = currentNSMap[prefix]\n\t\t\t\t\n\t\t\t\t//{console.log('###'+a.qName,domBuilder.locator.systemId+'',currentNSMap,a.uri)}\n\t\t\t}\n\t\t}\n\t}\n\tvar nsp = tagName.indexOf(':');\n\tif(nsp>0){\n\t\tprefix = el.prefix = tagName.slice(0,nsp);\n\t\tlocalName = el.localName = tagName.slice(nsp+1);\n\t}else{\n\t\tprefix = null;//important!!\n\t\tlocalName = el.localName = tagName;\n\t}\n\t//no prefix element has default namespace\n\tvar ns = el.uri = currentNSMap[prefix || ''];\n\tdomBuilder.startElement(ns,localName,tagName,el);\n\t//endPrefixMapping and startPrefixMapping have not any help for dom builder\n\t//localNSMap = null\n\tif(el.closed){\n\t\tdomBuilder.endElement(ns,localName,tagName);\n\t\tif(localNSMap){\n\t\t\tfor(prefix in localNSMap){\n\t\t\t\tdomBuilder.endPrefixMapping(prefix) \n\t\t\t}\n\t\t}\n\t}else{\n\t\tel.currentNSMap = currentNSMap;\n\t\tel.localNSMap = localNSMap;\n\t\tparseStack.push(el);\n\t}\n}\nfunction parseHtmlSpecialContent(source,elStartEnd,tagName,entityReplacer,domBuilder){\n\tif(/^(?:script|textarea)$/i.test(tagName)){\n\t\tvar elEndStart =  source.indexOf('</'+tagName+'>',elStartEnd);\n\t\tvar text = source.substring(elStartEnd+1,elEndStart);\n\t\tif(/[&<]/.test(text)){\n\t\t\tif(/^script$/i.test(tagName)){\n\t\t\t\t//if(!/\\]\\]>/.test(text)){\n\t\t\t\t\t//lexHandler.startCDATA();\n\t\t\t\t\tdomBuilder.characters(text,0,text.length);\n\t\t\t\t\t//lexHandler.endCDATA();\n\t\t\t\t\treturn elEndStart;\n\t\t\t\t//}\n\t\t\t}//}else{//text area\n\t\t\t\ttext = text.replace(/&#?\\w+;/g,entityReplacer);\n\t\t\t\tdomBuilder.characters(text,0,text.length);\n\t\t\t\treturn elEndStart;\n\t\t\t//}\n\t\t\t\n\t\t}\n\t}\n\treturn elStartEnd+1;\n}\nfunction fixSelfClosed(source,elStartEnd,tagName,closeMap){\n\t//if(tagName in closeMap){\n\tvar pos = closeMap[tagName];\n\tif(pos == null){\n\t\t//console.log(tagName)\n\t\tpos = closeMap[tagName] = source.lastIndexOf('</'+tagName+'>')\n\t}\n\treturn pos<elStartEnd;\n\t//} \n}\nfunction _copy(source,target){\n\tfor(var n in source){target[n] = source[n]}\n}\nfunction parseDCC(source,start,domBuilder,errorHandler){//sure start with '<!'\n\tvar next= source.charAt(start+2)\n\tswitch(next){\n\tcase '-':\n\t\tif(source.charAt(start + 3) === '-'){\n\t\t\tvar end = source.indexOf('-->',start+4);\n\t\t\t//append comment source.substring(4,end)//<!--\n\t\t\tif(end>start){\n\t\t\t\tdomBuilder.comment(source,start+4,end-start-4);\n\t\t\t\treturn end+3;\n\t\t\t}else{\n\t\t\t\terrorHandler.error(\"Unclosed comment\");\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}else{\n\t\t\t//error\n\t\t\treturn -1;\n\t\t}\n\tdefault:\n\t\tif(source.substr(start+3,6) == 'CDATA['){\n\t\t\tvar end = source.indexOf(']]>',start+9);\n\t\t\tdomBuilder.startCDATA();\n\t\t\tdomBuilder.characters(source,start+9,end-start-9);\n\t\t\tdomBuilder.endCDATA() \n\t\t\treturn end+3;\n\t\t}\n\t\t//<!DOCTYPE\n\t\t//startDTD(java.lang.String name, java.lang.String publicId, java.lang.String systemId) \n\t\tvar matchs = split(source,start);\n\t\tvar len = matchs.length;\n\t\tif(len>1 && /!doctype/i.test(matchs[0][0])){\n\t\t\tvar name = matchs[1][0];\n\t\t\tvar pubid = len>3 && /^public$/i.test(matchs[2][0]) && matchs[3][0]\n\t\t\tvar sysid = len>4 && matchs[4][0];\n\t\t\tvar lastMatch = matchs[len-1]\n\t\t\tdomBuilder.startDTD(name,pubid && pubid.replace(/^(['\"])(.*?)\\1$/,'$2'),\n\t\t\t\t\tsysid && sysid.replace(/^(['\"])(.*?)\\1$/,'$2'));\n\t\t\tdomBuilder.endDTD();\n\t\t\t\n\t\t\treturn lastMatch.index+lastMatch[0].length\n\t\t}\n\t}\n\treturn -1;\n}\n\n\n\nfunction parseInstruction(source,start,domBuilder){\n\tvar end = source.indexOf('?>',start);\n\tif(end){\n\t\tvar match = source.substring(start,end).match(/^<\\?(\\S*)\\s*([\\s\\S]*?)\\s*$/);\n\t\tif(match){\n\t\t\tvar len = match[0].length;\n\t\t\tdomBuilder.processingInstruction(match[1], match[2]) ;\n\t\t\treturn end+2;\n\t\t}else{//error\n\t\t\treturn -1;\n\t\t}\n\t}\n\treturn -1;\n}\n\n/**\n * @param source\n */\nfunction ElementAttributes(source){\n\t\n}\nElementAttributes.prototype = {\n\tsetTagName:function(tagName){\n\t\tif(!tagNamePattern.test(tagName)){\n\t\t\tthrow new Error('invalid tagName:'+tagName)\n\t\t}\n\t\tthis.tagName = tagName\n\t},\n\tadd:function(qName,value,offset){\n\t\tif(!tagNamePattern.test(qName)){\n\t\t\tthrow new Error('invalid attribute:'+qName)\n\t\t}\n\t\tthis[this.length++] = {qName:qName,value:value,offset:offset}\n\t},\n\tlength:0,\n\tgetLocalName:function(i){return this[i].localName},\n\tgetOffset:function(i){return this[i].offset},\n\tgetQName:function(i){return this[i].qName},\n\tgetURI:function(i){return this[i].uri},\n\tgetValue:function(i){return this[i].value}\n//\t,getIndex:function(uri, localName)){\n//\t\tif(localName){\n//\t\t\t\n//\t\t}else{\n//\t\t\tvar qName = uri\n//\t\t}\n//\t},\n//\tgetValue:function(){return this.getValue(this.getIndex.apply(this,arguments))},\n//\tgetType:function(uri,localName){}\n//\tgetType:function(i){},\n}\n\n\n\n\nfunction _set_proto_(thiz,parent){\n\tthiz.__proto__ = parent;\n\treturn thiz;\n}\nif(!(_set_proto_({},_set_proto_.prototype) instanceof _set_proto_)){\n\t_set_proto_ = function(thiz,parent){\n\t\tfunction p(){};\n\t\tp.prototype = parent;\n\t\tp = new p();\n\t\tfor(parent in thiz){\n\t\t\tp[parent] = thiz[parent];\n\t\t}\n\t\treturn p;\n\t}\n}\n\nfunction split(source,start){\n\tvar match;\n\tvar buf = [];\n\tvar reg = /'[^']+'|\"[^\"]+\"|[^\\s<>\\/=]+=?|(\\/?\\s*>|<)/g;\n\treg.lastIndex = start;\n\treg.exec(source);//skip <\n\twhile(match = reg.exec(source)){\n\t\tbuf.push(match);\n\t\tif(match[1])return buf;\n\t}\n}\n\nreturn XMLReader;\n});\n\n\n"]}
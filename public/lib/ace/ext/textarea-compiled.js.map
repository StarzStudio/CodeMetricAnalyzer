{"version":3,"sources":["textarea.js"],"names":[],"mappings":"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","file":"textarea-compiled.js","sourcesContent":["/* ***** BEGIN LICENSE BLOCK *****\n * Distributed under the BSD license:\n *\n * Copyright (c) 2010, Ajax.org B.V.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *     * Redistributions of source code must retain the above copyright\n *       notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above copyright\n *       notice, this list of conditions and the following disclaimer in the\n *       documentation and/or other materials provided with the distribution.\n *     * Neither the name of Ajax.org B.V. nor the\n *       names of its contributors may be used to endorse or promote products\n *       derived from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * ***** END LICENSE BLOCK ***** */\n\ndefine(function(require, exports, module) {\n\"use strict\";\n\nvar event = require(\"../lib/event\");\nvar UA = require(\"../lib/useragent\");\nvar net = require(\"../lib/net\");\nvar ace = require(\"../ace\");\n\nrequire(\"../theme/textmate\");\n\nmodule.exports = exports = ace;\n\n/*\n * Returns the CSS property of element.\n *   1) If the CSS property is on the style object of the element, use it, OR\n *   2) Compute the CSS property\n *\n * If the property can't get computed, is 'auto' or 'intrinsic', the former\n * calculated property is used (this can happen in cases where the textarea\n * is hidden and has no dimension styles).\n */\nvar getCSSProperty = function(element, container, property) {\n    var ret = element.style[property];\n\n    if (!ret) {\n        if (window.getComputedStyle) {\n            ret = window.getComputedStyle(element, '').getPropertyValue(property);\n        } else {\n            ret = element.currentStyle[property];\n        }\n    }\n\n    if (!ret || ret == 'auto' || ret == 'intrinsic') {\n        ret = container.style[property];\n    }\n    return ret;\n};\n\nfunction applyStyles(elm, styles) {\n    for (var style in styles) {\n        elm.style[style] = styles[style];\n    }\n}\n\nfunction setupContainer(element, getValue) {\n    if (element.type != 'textarea') {\n        throw new Error(\"Textarea required!\");\n    }\n\n    var parentNode = element.parentNode;\n\n    // This will hold the editor.\n    var container = document.createElement('div');\n\n    // To put Ace in the place of the textarea, we have to copy a few of the\n    // textarea's style attributes to the div container.\n    //\n    // The problem is that the properties have to get computed (they might be\n    // defined by a CSS file on the page - you can't access such rules that\n    // apply to an element via elm.style). Computed properties are converted to\n    // pixels although the dimension might be given as percentage. When the\n    // window resizes, the dimensions defined by percentages changes, so the\n    // properties have to get recomputed to get the new/true pixels.\n    var resizeEvent = function() {\n        var style = 'position:relative;';\n        [\n            'margin-top', 'margin-left', 'margin-right', 'margin-bottom'\n        ].forEach(function(item) {\n            style += item + ':' +\n                        getCSSProperty(element, container, item) + ';';\n        });\n\n        // Calculating the width/height of the textarea is somewhat tricky. To\n        // do it right, you have to include the paddings to the sides as well\n        // (eg. width = width + padding-left, -right).  This works well, as\n        // long as the width of the element is not set or given in pixels. In\n        // this case and after the textarea is hidden, getCSSProperty(element,\n        // container, 'width') will still return pixel value. If the element\n        // has realtiv dimensions (e.g. width='95<percent>')\n        // getCSSProperty(...) will return pixel values only as long as the\n        // textarea is visible. After it is hidden getCSSProperty will return\n        // the relative dimensions as they are set on the element (in the case\n        // of width, 95<percent>).\n        // Making the sum of pixel vaules (e.g. padding) and realtive values\n        // (e.g. <percent>) is not possible. As such the padding styles are\n        // ignored.\n\n        // The complete width is the width of the textarea + the padding\n        // to the left and right.\n        var width = getCSSProperty(element, container, 'width') || (element.clientWidth + \"px\");\n        var height = getCSSProperty(element, container, 'height')  || (element.clientHeight + \"px\");\n        style += 'height:' + height + ';width:' + width + ';';\n\n        // Set the display property to 'inline-block'.\n        style += 'display:inline-block;';\n        container.setAttribute('style', style);\n    };\n    event.addListener(window, 'resize', resizeEvent);\n\n    // Call the resizeEvent once, so that the size of the container is\n    // calculated.\n    resizeEvent();\n\n    // Insert the div container after the element.\n    parentNode.insertBefore(container, element.nextSibling);\n\n    // Override the forms onsubmit function. Set the innerHTML and value\n    // of the textarea before submitting.\n    while (parentNode !== document) {\n        if (parentNode.tagName.toUpperCase() === 'FORM') {\n            var oldSumit = parentNode.onsubmit;\n            // Override the onsubmit function of the form.\n            parentNode.onsubmit = function(evt) {\n                element.value = getValue();\n                // If there is a onsubmit function already, then call\n                // it with the current context and pass the event.\n                if (oldSumit) {\n                    oldSumit.call(this, evt);\n                }\n            };\n            break;\n        }\n        parentNode = parentNode.parentNode;\n    }\n    return container;\n}\n\nexports.transformTextarea = function(element, options) {\n    var session;\n    var container = setupContainer(element, function() {\n        return session.getValue();\n    });\n\n    // Hide the element.\n    element.style.display = 'none';\n    container.style.background = 'white';\n\n    //\n    var editorDiv = document.createElement(\"div\");\n    applyStyles(editorDiv, {\n        top: \"0px\",\n        left: \"0px\",\n        right: \"0px\",\n        bottom: \"0px\",\n        border: \"1px solid gray\",\n        position: \"absolute\"\n    });\n    container.appendChild(editorDiv);\n\n    var settingOpener = document.createElement(\"div\");\n    applyStyles(settingOpener, {\n        position: \"absolute\",\n        right: \"0px\",\n        bottom: \"0px\",\n        background: \"red\",\n        cursor: \"nw-resize\",\n        borderStyle: \"solid\",\n        borderWidth: \"9px 8px 10px 9px\",\n        width: \"2px\",\n        borderColor: \"lightblue gray gray lightblue\",\n        zIndex: 101\n    });\n\n    var settingDiv = document.createElement(\"div\");\n    var settingDivStyles = {\n        top: \"0px\",\n        left: \"20%\",\n        right: \"0px\",\n        bottom: \"0px\",\n        position: \"absolute\",\n        padding: \"5px\",\n        zIndex: 100,\n        color: \"white\",\n        display: \"none\",\n        overflow: \"auto\",\n        fontSize: \"14px\",\n        boxShadow: \"-5px 2px 3px gray\"\n    };\n    if (!UA.isOldIE) {\n        settingDivStyles.backgroundColor = \"rgba(0, 0, 0, 0.6)\";\n    } else {\n        settingDivStyles.backgroundColor = \"#333\";\n    }\n\n    applyStyles(settingDiv, settingDivStyles);\n    container.appendChild(settingDiv);\n\n    options = options || exports.defaultOptions;\n    // Power up ace on the textarea:\n    var editor = ace.edit(editorDiv);\n    session = editor.getSession();\n\n    session.setValue(element.value || element.innerHTML);\n    editor.focus();\n\n    // Add the settingPanel opener to the editor's div.\n    container.appendChild(settingOpener);\n\n    // Create the API.\n    setupApi(editor, editorDiv, settingDiv, ace, options, load);\n\n    // Create the setting's panel.\n    setupSettingPanel(settingDiv, settingOpener, editor);\n\n    var state = \"\";\n    event.addListener(settingOpener, \"mousemove\", function(e) {\n        var rect = this.getBoundingClientRect();\n        var x = e.clientX - rect.left, y = e.clientY - rect.top;\n        if (x + y < (rect.width + rect.height)/2) {\n            this.style.cursor = \"pointer\";\n            state = \"toggle\";\n        } else {\n            state = \"resize\";\n            this.style.cursor = \"nw-resize\";\n        }\n    });\n\n    event.addListener(settingOpener, \"mousedown\", function(e) {\n        if (state == \"toggle\") {\n            editor.setDisplaySettings();\n            return;\n        }\n        container.style.zIndex = 100000;\n        var rect = container.getBoundingClientRect();\n        var startX = rect.width  + rect.left - e.clientX;\n        var startY = rect.height  + rect.top - e.clientY;\n        event.capture(settingOpener, function(e) {\n            container.style.width = e.clientX - rect.left + startX + \"px\";\n            container.style.height = e.clientY - rect.top + startY + \"px\";\n            editor.resize();\n        }, function() {});\n    });\n\n    return editor;\n};\n\nfunction load(url, module, callback) {\n    net.loadScript(url, function() {\n        require([module], callback);\n    });\n}\n\nfunction setupApi(editor, editorDiv, settingDiv, ace, options, loader) {\n    var session = editor.getSession();\n    var renderer = editor.renderer;\n    loader = loader || load;\n\n    function toBool(value) {\n        return value === \"true\" || value == true;\n    }\n\n    editor.setDisplaySettings = function(display) {\n        if (display == null)\n            display = settingDiv.style.display == \"none\";\n        if (display) {\n            settingDiv.style.display = \"block\";\n            settingDiv.hideButton.focus();\n            editor.on(\"focus\", function onFocus() {\n                editor.removeListener(\"focus\", onFocus);\n                settingDiv.style.display = \"none\";\n            });\n        } else {\n            editor.focus();\n        }\n    };\n\n    editor.$setOption = editor.setOption;\n    editor.$getOption = editor.getOption;\n    editor.setOption = function(key, value) {\n        switch (key) {\n            case \"mode\":\n                editor.$setOption(\"mode\", \"ace/mode/\" + value)\n            break;\n            case \"theme\":\n                editor.$setOption(\"theme\", \"ace/theme/\" + value)\n            break;\n            case \"keybindings\":\n                switch (value) {\n                    case \"vim\":\n                        editor.setKeyboardHandler(\"ace/keyboard/vim\");\n                        break;\n                    case \"emacs\":\n                        editor.setKeyboardHandler(\"ace/keyboard/emacs\");\n                        break;\n                    default:\n                        editor.setKeyboardHandler(null);\n                }\n            break;\n\n            case \"softWrap\":\n            case \"fontSize\":\n                editor.$setOption(key, value);\n            break;\n            \n            default:\n                editor.$setOption(key, toBool(value));\n        }\n    };\n\n    editor.getOption = function(key) {\n        switch (key) {\n            case \"mode\":\n                return editor.$getOption(\"mode\").substr(\"ace/mode/\".length)\n            break;\n\n            case \"theme\":\n                return editor.$getOption(\"theme\").substr(\"ace/theme/\".length)\n            break;\n\n            case \"keybindings\":\n                var value = editor.getKeyboardHandler()\n                switch (value && value.$id) {\n                    case \"ace/keyboard/vim\":\n                        return \"vim\";\n                    case \"ace/keyboard/emacs\":\n                        return \"emacs\";\n                    default:\n                        return \"ace\";\n                }\n            break;\n\n            default:\n                return editor.$getOption(key);\n        }\n    };\n\n    editor.setOptions(options);\n    return editor;\n}\n\nfunction setupSettingPanel(settingDiv, settingOpener, editor) {\n    var BOOL = null;\n\n    var desc = {\n        mode:            \"Mode:\",\n        wrap:            \"Soft Wrap:\",\n        theme:           \"Theme:\",\n        fontSize:        \"Font Size:\",\n        showGutter:      \"Display Gutter:\",\n        keybindings:     \"Keyboard\",\n        showPrintMargin: \"Show Print Margin:\",\n        useSoftTabs:     \"Use Soft Tabs:\",\n        showInvisibles:  \"Show Invisibles\"\n    };\n\n    var optionValues = {\n        mode: {\n            text:       \"Plain\",\n            javascript: \"JavaScript\",\n            xml:        \"XML\",\n            html:       \"HTML\",\n            css:        \"CSS\",\n            scss:       \"SCSS\",\n            python:     \"Python\",\n            php:        \"PHP\",\n            java:       \"Java\",\n            ruby:       \"Ruby\",\n            c_cpp:      \"C/C++\",\n            coffee:     \"CoffeeScript\",\n            json:       \"json\",\n            perl:       \"Perl\",\n            clojure:    \"Clojure\",\n            ocaml:      \"OCaml\",\n            csharp:     \"C#\",\n            haxe:       \"haXe\",\n            svg:        \"SVG\",\n            textile:    \"Textile\",\n            groovy:     \"Groovy\",\n            liquid:     \"Liquid\",\n            Scala:      \"Scala\"\n        },\n        theme: {\n            clouds:           \"Clouds\",\n            clouds_midnight:  \"Clouds Midnight\",\n            cobalt:           \"Cobalt\",\n            crimson_editor:   \"Crimson Editor\",\n            dawn:             \"Dawn\",\n            gob:              \"Green on Black\",\n            eclipse:          \"Eclipse\",\n            idle_fingers:     \"Idle Fingers\",\n            kr_theme:         \"Kr Theme\",\n            merbivore:        \"Merbivore\",\n            merbivore_soft:   \"Merbivore Soft\",\n            mono_industrial:  \"Mono Industrial\",\n            monokai:          \"Monokai\",\n            pastel_on_dark:   \"Pastel On Dark\",\n            solarized_dark:   \"Solarized Dark\",\n            solarized_light:  \"Solarized Light\",\n            textmate:         \"Textmate\",\n            twilight:         \"Twilight\",\n            vibrant_ink:      \"Vibrant Ink\"\n        },\n        showGutter: BOOL,\n        fontSize: {\n            \"10px\": \"10px\",\n            \"11px\": \"11px\",\n            \"12px\": \"12px\",\n            \"14px\": \"14px\",\n            \"16px\": \"16px\"\n        },\n        wrap: {\n            off:    \"Off\",\n            40:     \"40\",\n            80:     \"80\",\n            free:   \"Free\"\n        },\n        keybindings: {\n            ace: \"ace\",\n            vim: \"vim\",\n            emacs: \"emacs\"\n        },\n        showPrintMargin:    BOOL,\n        useSoftTabs:        BOOL,\n        showInvisibles:     BOOL\n    };\n\n    var table = [];\n    table.push(\"<table><tr><th>Setting</th><th>Value</th></tr>\");\n\n    function renderOption(builder, option, obj, cValue) {\n        if (!obj) {\n            builder.push(\n                \"<input type='checkbox' title='\", option, \"' \",\n                    cValue + \"\" == \"true\" ? \"checked='true'\" : \"\",\n               \"'></input>\"\n            );\n            return;\n        }\n        builder.push(\"<select title='\" + option + \"'>\");\n        for (var value in obj) {\n            builder.push(\"<option value='\" + value + \"' \");\n\n            if (cValue == value) {\n                builder.push(\" selected \");\n            }\n\n            builder.push(\">\",\n                obj[value],\n                \"</option>\");\n        }\n        builder.push(\"</select>\");\n    }\n\n    for (var option in exports.defaultOptions) {\n        table.push(\"<tr><td>\", desc[option], \"</td>\");\n        table.push(\"<td>\");\n        renderOption(table, option, optionValues[option], editor.getOption(option));\n        table.push(\"</td></tr>\");\n    }\n    table.push(\"</table>\");\n    settingDiv.innerHTML = table.join(\"\");\n\n    var onChange = function(e) {\n        var select = e.currentTarget;\n        editor.setOption(select.title, select.value);\n    };\n    var onClick = function(e) {\n        var cb = e.currentTarget;\n        editor.setOption(cb.title, cb.checked);\n    };\n    var selects = settingDiv.getElementsByTagName(\"select\");\n    for (var i = 0; i < selects.length; i++)\n        selects[i].onchange = onChange;\n    var cbs = settingDiv.getElementsByTagName(\"input\");\n    for (var i = 0; i < cbs.length; i++)\n        cbs[i].onclick = onClick;\n\n\n    var button = document.createElement(\"input\");\n    button.type = \"button\";\n    button.value = \"Hide\";\n    event.addListener(button, \"click\", function() {\n        editor.setDisplaySettings(false);\n    });\n    settingDiv.appendChild(button);\n    settingDiv.hideButton = button;\n}\n\n// Default startup options.\nexports.defaultOptions = {\n    mode:               \"javascript\",\n    theme:              \"textmate\",\n    wrap:               \"off\",\n    fontSize:           \"12px\",\n    showGutter:         \"false\",\n    keybindings:        \"ace\",\n    showPrintMargin:    \"false\",\n    useSoftTabs:        \"true\",\n    showInvisibles:     \"false\"\n};\n\n});\n"]}
{"version":3,"sources":["searchbox.js"],"names":[],"mappings":"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","file":"searchbox-compiled.js","sourcesContent":["/* ***** BEGIN LICENSE BLOCK *****\n * Distributed under the BSD license:\n *\n * Copyright (c) 2010, Ajax.org B.V.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *     * Redistributions of source code must retain the above copyright\n *       notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above copyright\n *       notice, this list of conditions and the following disclaimer in the\n *       documentation and/or other materials provided with the distribution.\n *     * Neither the name of Ajax.org B.V. nor the\n *       names of its contributors may be used to endorse or promote products\n *       derived from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * ***** END LICENSE BLOCK ***** */\n\ndefine(function(require, exports, module) {\n\"use strict\";\n\nvar dom = require(\"../lib/dom\");\nvar lang = require(\"../lib/lang\");\nvar event = require(\"../lib/event\");\nvar searchboxCss = require(\"../requirejs/text!./searchbox.css\");\nvar HashHandler = require(\"../keyboard/hash_handler\").HashHandler;\nvar keyUtil = require(\"../lib/keys\");\n\ndom.importCssString(searchboxCss, \"ace_searchbox\");\n\nvar html = '<div class=\"ace_search right\">\\\n    <button type=\"button\" action=\"hide\" class=\"ace_searchbtn_close\"></button>\\\n    <div class=\"ace_search_form\">\\\n        <input class=\"ace_search_field\" placeholder=\"Search for\" spellcheck=\"false\"></input>\\\n        <button type=\"button\" action=\"findNext\" class=\"ace_searchbtn next\"></button>\\\n        <button type=\"button\" action=\"findPrev\" class=\"ace_searchbtn prev\"></button>\\\n        <button type=\"button\" action=\"findAll\" class=\"ace_searchbtn\" title=\"Alt-Enter\">All</button>\\\n    </div>\\\n    <div class=\"ace_replace_form\">\\\n        <input class=\"ace_search_field\" placeholder=\"Replace with\" spellcheck=\"false\"></input>\\\n        <button type=\"button\" action=\"replaceAndFindNext\" class=\"ace_replacebtn\">Replace</button>\\\n        <button type=\"button\" action=\"replaceAll\" class=\"ace_replacebtn\">All</button>\\\n    </div>\\\n    <div class=\"ace_search_options\">\\\n        <span action=\"toggleRegexpMode\" class=\"ace_button\" title=\"RegExp Search\">.*</span>\\\n        <span action=\"toggleCaseSensitive\" class=\"ace_button\" title=\"CaseSensitive Search\">Aa</span>\\\n        <span action=\"toggleWholeWords\" class=\"ace_button\" title=\"Whole Word Search\">\\\\b</span>\\\n    </div>\\\n</div>'.replace(/>\\s+/g, \">\");\n\nvar SearchBox = function(editor, range, showReplaceForm) {\n    var div = dom.createElement(\"div\");\n    div.innerHTML = html;\n    this.element = div.firstChild;\n\n    this.$init();\n    this.setEditor(editor);\n};\n\n(function() {\n    this.setEditor = function(editor) {\n        editor.searchBox = this;\n        editor.container.appendChild(this.element);\n        this.editor = editor;\n    };\n\n    this.$initElements = function(sb) {\n        this.searchBox = sb.querySelector(\".ace_search_form\");\n        this.replaceBox = sb.querySelector(\".ace_replace_form\");\n        this.searchOptions = sb.querySelector(\".ace_search_options\");\n        this.regExpOption = sb.querySelector(\"[action=toggleRegexpMode]\");\n        this.caseSensitiveOption = sb.querySelector(\"[action=toggleCaseSensitive]\");\n        this.wholeWordOption = sb.querySelector(\"[action=toggleWholeWords]\");\n        this.searchInput = this.searchBox.querySelector(\".ace_search_field\");\n        this.replaceInput = this.replaceBox.querySelector(\".ace_search_field\");\n    };\n    \n    this.$init = function() {\n        var sb = this.element;\n        \n        this.$initElements(sb);\n        \n        var _this = this;\n        event.addListener(sb, \"mousedown\", function(e) {\n            setTimeout(function(){\n                _this.activeInput.focus();\n            }, 0);\n            event.stopPropagation(e);\n        });\n        event.addListener(sb, \"click\", function(e) {\n            var t = e.target || e.srcElement;\n            var action = t.getAttribute(\"action\");\n            if (action && _this[action])\n                _this[action]();\n            else if (_this.$searchBarKb.commands[action])\n                _this.$searchBarKb.commands[action].exec(_this);\n            event.stopPropagation(e);\n        });\n\n        event.addCommandKeyListener(sb, function(e, hashId, keyCode) {\n            var keyString = keyUtil.keyCodeToString(keyCode);\n            var command = _this.$searchBarKb.findKeyCommand(hashId, keyString);\n            if (command && command.exec) {\n                command.exec(_this);\n                event.stopEvent(e);\n            }\n        });\n\n        this.$onChange = lang.delayedCall(function() {\n            _this.find(false, false);\n        });\n\n        event.addListener(this.searchInput, \"input\", function() {\n            _this.$onChange.schedule(20);\n        });\n        event.addListener(this.searchInput, \"focus\", function() {\n            _this.activeInput = _this.searchInput;\n            _this.searchInput.value && _this.highlight();\n        });\n        event.addListener(this.replaceInput, \"focus\", function() {\n            _this.activeInput = _this.replaceInput;\n            _this.searchInput.value && _this.highlight();\n        });\n    };\n\n    //keybinging outsite of the searchbox\n    this.$closeSearchBarKb = new HashHandler([{\n        bindKey: \"Esc\",\n        name: \"closeSearchBar\",\n        exec: function(editor) {\n            editor.searchBox.hide();\n        }\n    }]);\n\n    //keybinging outsite of the searchbox\n    this.$searchBarKb = new HashHandler();\n    this.$searchBarKb.bindKeys({\n        \"Ctrl-f|Command-f\": function(sb) {\n            var isReplace = sb.isReplace = !sb.isReplace;\n            sb.replaceBox.style.display = isReplace ? \"\" : \"none\";\n            sb.searchInput.focus();\n        },\n        \"Ctrl-H|Command-Option-F\": function(sb) {\n            sb.replaceBox.style.display = \"\";\n            sb.replaceInput.focus();\n        },\n        \"Ctrl-G|Command-G\": function(sb) {\n            sb.findNext();\n        },\n        \"Ctrl-Shift-G|Command-Shift-G\": function(sb) {\n            sb.findPrev();\n        },\n        \"esc\": function(sb) {\n            setTimeout(function() { sb.hide();});\n        },\n        \"Return\": function(sb) {\n            if (sb.activeInput == sb.replaceInput)\n                sb.replace();\n            sb.findNext();\n        },\n        \"Shift-Return\": function(sb) {\n            if (sb.activeInput == sb.replaceInput)\n                sb.replace();\n            sb.findPrev();\n        },\n        \"Alt-Return\": function(sb) {\n            if (sb.activeInput == sb.replaceInput)\n                sb.replaceAll();\n            sb.findAll();\n        },\n        \"Tab\": function(sb) {\n            (sb.activeInput == sb.replaceInput ? sb.searchInput : sb.replaceInput).focus();\n        }\n    });\n\n    this.$searchBarKb.addCommands([{\n        name: \"toggleRegexpMode\",\n        bindKey: {win: \"Alt-R|Alt-/\", mac: \"Ctrl-Alt-R|Ctrl-Alt-/\"},\n        exec: function(sb) {\n            sb.regExpOption.checked = !sb.regExpOption.checked;\n            sb.$syncOptions();\n        }\n    }, {\n        name: \"toggleCaseSensitive\",\n        bindKey: {win: \"Alt-C|Alt-I\", mac: \"Ctrl-Alt-R|Ctrl-Alt-I\"},\n        exec: function(sb) {\n            sb.caseSensitiveOption.checked = !sb.caseSensitiveOption.checked;\n            sb.$syncOptions();\n        }\n    }, {\n        name: \"toggleWholeWords\",\n        bindKey: {win: \"Alt-B|Alt-W\", mac: \"Ctrl-Alt-B|Ctrl-Alt-W\"},\n        exec: function(sb) {\n            sb.wholeWordOption.checked = !sb.wholeWordOption.checked;\n            sb.$syncOptions();\n        }\n    }]);\n\n    this.$syncOptions = function() {\n        dom.setCssClass(this.regExpOption, \"checked\", this.regExpOption.checked);\n        dom.setCssClass(this.wholeWordOption, \"checked\", this.wholeWordOption.checked);\n        dom.setCssClass(this.caseSensitiveOption, \"checked\", this.caseSensitiveOption.checked);\n        this.find(false, false);\n    };\n\n    this.highlight = function(re) {\n        this.editor.session.highlight(re || this.editor.$search.$options.re);\n        this.editor.renderer.updateBackMarkers()\n    };\n    this.find = function(skipCurrent, backwards, preventScroll) {\n        var range = this.editor.find(this.searchInput.value, {\n            skipCurrent: skipCurrent,\n            backwards: backwards,\n            wrap: true,\n            regExp: this.regExpOption.checked,\n            caseSensitive: this.caseSensitiveOption.checked,\n            wholeWord: this.wholeWordOption.checked,\n            preventScroll: preventScroll\n        });\n        var noMatch = !range && this.searchInput.value;\n        dom.setCssClass(this.searchBox, \"ace_nomatch\", noMatch);\n        this.editor._emit(\"findSearchBox\", { match: !noMatch });\n        this.highlight();\n    };\n    this.findNext = function() {\n        this.find(true, false);\n    };\n    this.findPrev = function() {\n        this.find(true, true);\n    };\n    this.findAll = function(){\n        var range = this.editor.findAll(this.searchInput.value, {            \n            regExp: this.regExpOption.checked,\n            caseSensitive: this.caseSensitiveOption.checked,\n            wholeWord: this.wholeWordOption.checked\n        });\n        var noMatch = !range && this.searchInput.value;\n        dom.setCssClass(this.searchBox, \"ace_nomatch\", noMatch);\n        this.editor._emit(\"findSearchBox\", { match: !noMatch });\n        this.highlight();\n        this.hide();\n    };\n    this.replace = function() {\n        if (!this.editor.getReadOnly())\n            this.editor.replace(this.replaceInput.value);\n    };    \n    this.replaceAndFindNext = function() {\n        if (!this.editor.getReadOnly()) {\n            this.editor.replace(this.replaceInput.value);\n            this.findNext()\n        }\n    };\n    this.replaceAll = function() {\n        if (!this.editor.getReadOnly())\n            this.editor.replaceAll(this.replaceInput.value);\n    };\n\n    this.hide = function() {\n        this.element.style.display = \"none\";\n        this.editor.keyBinding.removeKeyboardHandler(this.$closeSearchBarKb);\n        this.editor.focus();\n    };\n    this.show = function(value, isReplace) {\n        this.element.style.display = \"\";\n        this.replaceBox.style.display = isReplace ? \"\" : \"none\";\n\n        this.isReplace = isReplace;\n\n        if (value)\n            this.searchInput.value = value;\n        \n        this.find(false, false, true);\n        \n        this.searchInput.focus();\n        this.searchInput.select();\n\n        this.editor.keyBinding.addKeyboardHandler(this.$closeSearchBarKb);\n    };\n\n    this.isFocused = function() {\n        var el = document.activeElement;\n        return el == this.searchInput || el == this.replaceInput;\n    }\n}).call(SearchBox.prototype);\n\nexports.SearchBox = SearchBox;\n\nexports.Search = function(editor, isReplace) {\n    var sb = editor.searchBox || new SearchBox(editor);\n    sb.show(editor.session.getTextRange(), isReplace);\n};\n\n});\n\n\n/* ------------------------------------------------------------------------------------------\n * TODO\n * --------------------------------------------------------------------------------------- */\n/*\n- move search form to the left if it masks current word\n- includ all options that search has. ex: regex\n- searchbox.searchbox is not that pretty. we should have just searchbox\n- disable prev button if it makes sence\n*/\n"]}
{"version":3,"sources":["springy.js"],"names":[],"mappings":"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","file":"springy-compiled.js","sourcesContent":["/**\n * Springy v2.7.1\n *\n * Copyright (c) 2010-2013 Dennis Hotson\n *\n * Permission is hereby granted, free of charge, to any person\n * obtaining a copy of this software and associated documentation\n * files (the \"Software\"), to deal in the Software without\n * restriction, including without limitation the rights to use,\n * copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following\n * conditions:\n *\n * The above copyright notice and this permission notice shall be\n * included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n * OTHER DEALINGS IN THE SOFTWARE.\n */\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(function () {\n            return (root.returnExportsGlobal = factory());\n        });\n    } else if (typeof exports === 'object') {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like enviroments that support module.exports,\n        // like Node.\n        module.exports = factory();\n    } else {\n        // Browser globals\n        root.Springy = factory();\n    }\n}(this, function() {\n\n\tvar Springy = {};\n\n\tvar Graph = Springy.Graph = function() {\n\t\tthis.nodeSet = {};\n\t\tthis.nodes = [];\n\t\tthis.edges = [];\n\t\tthis.adjacency = {};\n\n\t\tthis.nextNodeId = 0;\n\t\tthis.nextEdgeId = 0;\n\t\tthis.eventListeners = [];\n\t};\n\n\tvar Node = Springy.Node = function(id, data) {\n\t\tthis.id = id;\n\t\tthis.data = (data !== undefined) ? data : {};\n\n\t// Data fields used by layout algorithm in this file:\n\t// this.data.mass\n\t// Data used by default renderer in springyui.js\n\t// this.data.label\n\t};\n\n\tvar Edge = Springy.Edge = function(id, source, target, data) {\n\t\tthis.id = id;\n\t\tthis.source = source;\n\t\tthis.target = target;\n\t\tthis.data = (data !== undefined) ? data : {};\n\n\t// Edge data field used by layout alorithm\n\t// this.data.length\n\t// this.data.type\n\t};\n\n\tGraph.prototype.addNode = function(node) {\n\t\tif (!(node.id in this.nodeSet)) {\n\t\t\tthis.nodes.push(node);\n\t\t}\n\n\t\tthis.nodeSet[node.id] = node;\n\n\t\tthis.notify();\n\t\treturn node;\n\t};\n\n\tGraph.prototype.addNodes = function() {\n\t\t// accepts variable number of arguments, where each argument\n\t\t// is a string that becomes both node identifier and label\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar name = arguments[i];\n\t\t\tvar node = new Node(name, {label:name});\n\t\t\tthis.addNode(node);\n\t\t}\n\t};\n\n\tGraph.prototype.addEdge = function(edge) {\n\t\tvar exists = false;\n\t\tthis.edges.forEach(function(e) {\n\t\t\tif (edge.id === e.id) { exists = true; }\n\t\t});\n\n\t\tif (!exists) {\n\t\t\tthis.edges.push(edge);\n\t\t}\n\n\t\tif (!(edge.source.id in this.adjacency)) {\n\t\t\tthis.adjacency[edge.source.id] = {};\n\t\t}\n\t\tif (!(edge.target.id in this.adjacency[edge.source.id])) {\n\t\t\tthis.adjacency[edge.source.id][edge.target.id] = [];\n\t\t}\n\n\t\texists = false;\n\t\tthis.adjacency[edge.source.id][edge.target.id].forEach(function(e) {\n\t\t\t\tif (edge.id === e.id) { exists = true; }\n\t\t});\n\n\t\tif (!exists) {\n\t\t\tthis.adjacency[edge.source.id][edge.target.id].push(edge);\n\t\t}\n\n\t\tthis.notify();\n\t\treturn edge;\n\t};\n\n\tGraph.prototype.addEdges = function() {\n\t\t// accepts variable number of arguments, where each argument\n\t\t// is a triple [nodeid1, nodeid2, attributes]\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar e = arguments[i];\n\t\t\tvar node1 = this.nodeSet[e[0]];\n\t\t\tif (node1 == undefined) {\n\t\t\t\tthrow new TypeError(\"invalid node name: \" + e[0]);\n\t\t\t}\n\t\t\tvar node2 = this.nodeSet[e[1]];\n\t\t\tif (node2 == undefined) {\n\t\t\t\tthrow new TypeError(\"invalid node name: \" + e[1]);\n\t\t\t}\n\t\t\tvar attr = e[2];\n\n\t\t\tthis.newEdge(node1, node2, attr);\n\t\t}\n\t};\n\n\tGraph.prototype.newNode = function(data) {\n\t\tvar node = new Node(this.nextNodeId++, data);\n\t\tthis.addNode(node);\n\t\treturn node;\n\t};\n\n\tGraph.prototype.newEdge = function(source, target, data) {\n\t\tvar edge = new Edge(this.nextEdgeId++, source, target, data);\n\t\tthis.addEdge(edge);\n\t\treturn edge;\n\t};\n\n\n\t// add nodes and edges from JSON object\n\tGraph.prototype.loadJSON = function(json) {\n\t/**\n\tSpringy's simple JSON format for graphs.\n\n\thistorically, Springy uses separate lists\n\tof nodes and edges:\n\n\t\t{\n\t\t\t\"nodes\": [\n\t\t\t\t\"center\",\n\t\t\t\t\"left\",\n\t\t\t\t\"right\",\n\t\t\t\t\"up\",\n\t\t\t\t\"satellite\"\n\t\t\t],\n\t\t\t\"edges\": [\n\t\t\t\t[\"center\", \"left\"],\n\t\t\t\t[\"center\", \"right\"],\n\t\t\t\t[\"center\", \"up\"]\n\t\t\t]\n\t\t}\n\n\t**/\n\t\t// parse if a string is passed (EC5+ browsers)\n\t\tif (typeof json == 'string' || json instanceof String) {\n\t\t\tjson = JSON.parse( json );\n\t\t}\n\n\t\tif ('nodes' in json || 'edges' in json) {\n\t\t\tthis.addNodes.apply(this, json['nodes']);\n\t\t\tthis.addEdges.apply(this, json['edges']);\n\t\t}\n\t}\n\n\n\t// find the edges from node1 to node2\n\tGraph.prototype.getEdges = function(node1, node2) {\n\t\tif (node1.id in this.adjacency\n\t\t\t&& node2.id in this.adjacency[node1.id]) {\n\t\t\treturn this.adjacency[node1.id][node2.id];\n\t\t}\n\n\t\treturn [];\n\t};\n\n\t// remove a node and it's associated edges from the graph\n\tGraph.prototype.removeNode = function(node) {\n\t\tif (node.id in this.nodeSet) {\n\t\t\tdelete this.nodeSet[node.id];\n\t\t}\n\n\t\tfor (var i = this.nodes.length - 1; i >= 0; i--) {\n\t\t\tif (this.nodes[i].id === node.id) {\n\t\t\t\tthis.nodes.splice(i, 1);\n\t\t\t}\n\t\t}\n\n\t\tthis.detachNode(node);\n\t};\n\n\t// removes edges associated with a given node\n\tGraph.prototype.detachNode = function(node) {\n\t\tvar tmpEdges = this.edges.slice();\n\t\ttmpEdges.forEach(function(e) {\n\t\t\tif (e.source.id === node.id || e.target.id === node.id) {\n\t\t\t\tthis.removeEdge(e);\n\t\t\t}\n\t\t}, this);\n\n\t\tthis.notify();\n\t};\n\n\t// remove a node and it's associated edges from the graph\n\tGraph.prototype.removeEdge = function(edge) {\n\t\tfor (var i = this.edges.length - 1; i >= 0; i--) {\n\t\t\tif (this.edges[i].id === edge.id) {\n\t\t\t\tthis.edges.splice(i, 1);\n\t\t\t}\n\t\t}\n\n\t\tfor (var x in this.adjacency) {\n\t\t\tfor (var y in this.adjacency[x]) {\n\t\t\t\tvar edges = this.adjacency[x][y];\n\n\t\t\t\tfor (var j=edges.length - 1; j>=0; j--) {\n\t\t\t\t\tif (this.adjacency[x][y][j].id === edge.id) {\n\t\t\t\t\t\tthis.adjacency[x][y].splice(j, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Clean up empty edge arrays\n\t\t\t\tif (this.adjacency[x][y].length == 0) {\n\t\t\t\t\tdelete this.adjacency[x][y];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Clean up empty objects\n\t\t\tif (isEmpty(this.adjacency[x])) {\n\t\t\t\tdelete this.adjacency[x];\n\t\t\t}\n\t\t}\n\n\t\tthis.notify();\n\t};\n\n\t/* Merge a list of nodes and edges into the current graph. eg.\n\tvar o = {\n\t\tnodes: [\n\t\t\t{id: 123, data: {type: 'user', userid: 123, displayname: 'aaa'}},\n\t\t\t{id: 234, data: {type: 'user', userid: 234, displayname: 'bbb'}}\n\t\t],\n\t\tedges: [\n\t\t\t{from: 0, to: 1, type: 'submitted_design', directed: true, data: {weight: }}\n\t\t]\n\t}\n\t*/\n\tGraph.prototype.merge = function(data) {\n\t\tvar nodes = [];\n\t\tdata.nodes.forEach(function(n) {\n\t\t\tnodes.push(this.addNode(new Node(n.id, n.data)));\n\t\t}, this);\n\n\t\tdata.edges.forEach(function(e) {\n\t\t\tvar from = nodes[e.from];\n\t\t\tvar to = nodes[e.to];\n\n\t\t\tvar id = (e.directed)\n\t\t\t\t? (id = e.type + \"-\" + from.id + \"-\" + to.id)\n\t\t\t\t: (from.id < to.id) // normalise id for non-directed edges\n\t\t\t\t\t? e.type + \"-\" + from.id + \"-\" + to.id\n\t\t\t\t\t: e.type + \"-\" + to.id + \"-\" + from.id;\n\n\t\t\tvar edge = this.addEdge(new Edge(id, from, to, e.data));\n\t\t\tedge.data.type = e.type;\n\t\t}, this);\n\t};\n\n\tGraph.prototype.filterNodes = function(fn) {\n\t\tvar tmpNodes = this.nodes.slice();\n\t\ttmpNodes.forEach(function(n) {\n\t\t\tif (!fn(n)) {\n\t\t\t\tthis.removeNode(n);\n\t\t\t}\n\t\t}, this);\n\t};\n\n\tGraph.prototype.filterEdges = function(fn) {\n\t\tvar tmpEdges = this.edges.slice();\n\t\ttmpEdges.forEach(function(e) {\n\t\t\tif (!fn(e)) {\n\t\t\t\tthis.removeEdge(e);\n\t\t\t}\n\t\t}, this);\n\t};\n\n\n\tGraph.prototype.addGraphListener = function(obj) {\n\t\tthis.eventListeners.push(obj);\n\t};\n\n\tGraph.prototype.notify = function() {\n\t\tthis.eventListeners.forEach(function(obj){\n\t\t\tobj.graphChanged();\n\t\t});\n\t};\n\n\t// -----------\n\tvar Layout = Springy.Layout = {};\n\tLayout.ForceDirected = function(graph, stiffness, repulsion, damping, minEnergyThreshold, maxSpeed) {\n\t\tthis.graph = graph;\n\t\tthis.stiffness = stiffness; // spring stiffness constant\n\t\tthis.repulsion = repulsion; // repulsion constant\n\t\tthis.damping = damping; // velocity damping factor\n\t\tthis.minEnergyThreshold = minEnergyThreshold || 0.01; //threshold used to determine render stop\n\t\tthis.maxSpeed = maxSpeed || Infinity; // nodes aren't allowed to exceed this speed\n\n\t\tthis.nodePoints = {}; // keep track of points associated with nodes\n\t\tthis.edgeSprings = {}; // keep track of springs associated with edges\n\t};\n\n\tLayout.ForceDirected.prototype.point = function(node) {\n\t\tif (!(node.id in this.nodePoints)) {\n\t\t\tvar mass = (node.data.mass !== undefined) ? node.data.mass : 1.0;\n\t\t\tthis.nodePoints[node.id] = new Layout.ForceDirected.Point(Vector.random(), mass);\n\t\t}\n\n\t\treturn this.nodePoints[node.id];\n\t};\n\n\tLayout.ForceDirected.prototype.spring = function(edge) {\n\t\tif (!(edge.id in this.edgeSprings)) {\n\t\t\tvar length = (edge.data.length !== undefined) ? edge.data.length : 1.0;\n\n\t\t\tvar existingSpring = false;\n\n\t\t\tvar from = this.graph.getEdges(edge.source, edge.target);\n\t\t\tfrom.forEach(function(e) {\n\t\t\t\tif (existingSpring === false && e.id in this.edgeSprings) {\n\t\t\t\t\texistingSpring = this.edgeSprings[e.id];\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\tif (existingSpring !== false) {\n\t\t\t\treturn new Layout.ForceDirected.Spring(existingSpring.point1, existingSpring.point2, 0.0, 0.0);\n\t\t\t}\n\n\t\t\tvar to = this.graph.getEdges(edge.target, edge.source);\n\t\t\tfrom.forEach(function(e){\n\t\t\t\tif (existingSpring === false && e.id in this.edgeSprings) {\n\t\t\t\t\texistingSpring = this.edgeSprings[e.id];\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\tif (existingSpring !== false) {\n\t\t\t\treturn new Layout.ForceDirected.Spring(existingSpring.point2, existingSpring.point1, 0.0, 0.0);\n\t\t\t}\n\n\t\t\tthis.edgeSprings[edge.id] = new Layout.ForceDirected.Spring(\n\t\t\t\tthis.point(edge.source), this.point(edge.target), length, this.stiffness\n\t\t\t);\n\t\t}\n\n\t\treturn this.edgeSprings[edge.id];\n\t};\n\n\t// callback should accept two arguments: Node, Point\n\tLayout.ForceDirected.prototype.eachNode = function(callback) {\n\t\tvar t = this;\n\t\tthis.graph.nodes.forEach(function(n){\n\t\t\tcallback.call(t, n, t.point(n));\n\t\t});\n\t};\n\n\t// callback should accept two arguments: Edge, Spring\n\tLayout.ForceDirected.prototype.eachEdge = function(callback) {\n\t\tvar t = this;\n\t\tthis.graph.edges.forEach(function(e){\n\t\t\tcallback.call(t, e, t.spring(e));\n\t\t});\n\t};\n\n\t// callback should accept one argument: Spring\n\tLayout.ForceDirected.prototype.eachSpring = function(callback) {\n\t\tvar t = this;\n\t\tthis.graph.edges.forEach(function(e){\n\t\t\tcallback.call(t, t.spring(e));\n\t\t});\n\t};\n\n\n\t// Physics stuff\n\tLayout.ForceDirected.prototype.applyCoulombsLaw = function() {\n\t\tthis.eachNode(function(n1, point1) {\n\t\t\tthis.eachNode(function(n2, point2) {\n\t\t\t\tif (point1 !== point2)\n\t\t\t\t{\n\t\t\t\t\tvar d = point1.p.subtract(point2.p);\n\t\t\t\t\tvar distance = d.magnitude() + 0.1; // avoid massive forces at small distances (and divide by zero)\n\t\t\t\t\tvar direction = d.normalise();\n\n\t\t\t\t\t// apply force to each end point\n\t\t\t\t\tpoint1.applyForce(direction.multiply(this.repulsion).divide(distance * distance * 0.5));\n\t\t\t\t\tpoint2.applyForce(direction.multiply(this.repulsion).divide(distance * distance * -0.5));\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t};\n\n\tLayout.ForceDirected.prototype.applyHookesLaw = function() {\n\t\tthis.eachSpring(function(spring){\n\t\t\tvar d = spring.point2.p.subtract(spring.point1.p); // the direction of the spring\n\t\t\tvar displacement = spring.length - d.magnitude();\n\t\t\tvar direction = d.normalise();\n\n\t\t\t// apply force to each end point\n\t\t\tspring.point1.applyForce(direction.multiply(spring.k * displacement * -0.5));\n\t\t\tspring.point2.applyForce(direction.multiply(spring.k * displacement * 0.5));\n\t\t});\n\t};\n\n\tLayout.ForceDirected.prototype.attractToCentre = function() {\n\t\tthis.eachNode(function(node, point) {\n\t\t\tvar direction = point.p.multiply(-1.0);\n\t\t\tpoint.applyForce(direction.multiply(this.repulsion / 50.0));\n\t\t});\n\t};\n\n\n\tLayout.ForceDirected.prototype.updateVelocity = function(timestep) {\n\t\tthis.eachNode(function(node, point) {\n\t\t\t// Is this, along with updatePosition below, the only places that your\n\t\t\t// integration code exist?\n\t\t\tpoint.v = point.v.add(point.a.multiply(timestep)).multiply(this.damping);\n\t\t\tif (point.v.magnitude() > this.maxSpeed) {\n\t\t\t    point.v = point.v.normalise().multiply(this.maxSpeed);\n\t\t\t}\n\t\t\tpoint.a = new Vector(0,0);\n\t\t});\n\t};\n\n\tLayout.ForceDirected.prototype.updatePosition = function(timestep) {\n\t\tthis.eachNode(function(node, point) {\n\t\t\t// Same question as above; along with updateVelocity, is this all of\n\t\t\t// your integration code?\n\t\t\tpoint.p = point.p.add(point.v.multiply(timestep));\n\t\t});\n\t};\n\n\t// Calculate the total kinetic energy of the system\n\tLayout.ForceDirected.prototype.totalEnergy = function(timestep) {\n\t\tvar energy = 0.0;\n\t\tthis.eachNode(function(node, point) {\n\t\t\tvar speed = point.v.magnitude();\n\t\t\tenergy += 0.5 * point.m * speed * speed;\n\t\t});\n\n\t\treturn energy;\n\t};\n\n\tvar __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; }; // stolen from coffeescript, thanks jashkenas! ;-)\n\n\tSpringy.requestAnimationFrame = __bind(this.requestAnimationFrame ||\n\t\tthis.webkitRequestAnimationFrame ||\n\t\tthis.mozRequestAnimationFrame ||\n\t\tthis.oRequestAnimationFrame ||\n\t\tthis.msRequestAnimationFrame ||\n\t\t(function(callback, element) {\n\t\t\tthis.setTimeout(callback, 10);\n\t\t}), this);\n\n\n\t/**\n\t * Start simulation if it's not running already.\n\t * In case it's running then the call is ignored, and none of the callbacks passed is ever executed.\n\t */\n\tLayout.ForceDirected.prototype.start = function(render, onRenderStop, onRenderStart) {\n\t\tvar t = this;\n\n\t\tif (this._started) return;\n\t\tthis._started = true;\n\t\tthis._stop = false;\n\n\t\tif (onRenderStart !== undefined) { onRenderStart(); }\n\n\t\tSpringy.requestAnimationFrame(function step() {\n\t\t\tt.tick(0.03);\n\n\t\t\tif (render !== undefined) {\n\t\t\t\trender();\n\t\t\t}\n\n\t\t\t// stop simulation when energy of the system goes below a threshold\n\t\t\tif (t._stop || t.totalEnergy() < t.minEnergyThreshold) {\n\t\t\t\tt._started = false;\n\t\t\t\tif (onRenderStop !== undefined) { onRenderStop(); }\n\t\t\t} else {\n\t\t\t\tSpringy.requestAnimationFrame(step);\n\t\t\t}\n\t\t});\n\t};\n\n\tLayout.ForceDirected.prototype.stop = function() {\n\t\tthis._stop = true;\n\t}\n\n\tLayout.ForceDirected.prototype.tick = function(timestep) {\n\t\tthis.applyCoulombsLaw();\n\t\tthis.applyHookesLaw();\n\t\tthis.attractToCentre();\n\t\tthis.updateVelocity(timestep);\n\t\tthis.updatePosition(timestep);\n\t};\n\n\t// Find the nearest point to a particular position\n\tLayout.ForceDirected.prototype.nearest = function(pos) {\n\t\tvar min = {node: null, point: null, distance: null};\n\t\tvar t = this;\n\t\tthis.graph.nodes.forEach(function(n){\n\t\t\tvar point = t.point(n);\n\t\t\tvar distance = point.p.subtract(pos).magnitude();\n\n\t\t\tif (min.distance === null || distance < min.distance) {\n\t\t\t\tmin = {node: n, point: point, distance: distance};\n\t\t\t}\n\t\t});\n\n\t\treturn min;\n\t};\n\n\t// returns [bottomleft, topright]\n\tLayout.ForceDirected.prototype.getBoundingBox = function() {\n\t\tvar bottomleft = new Vector(-2,-2);\n\t\tvar topright = new Vector(2,2);\n\n\t\tthis.eachNode(function(n, point) {\n\t\t\tif (point.p.x < bottomleft.x) {\n\t\t\t\tbottomleft.x = point.p.x;\n\t\t\t}\n\t\t\tif (point.p.y < bottomleft.y) {\n\t\t\t\tbottomleft.y = point.p.y;\n\t\t\t}\n\t\t\tif (point.p.x > topright.x) {\n\t\t\t\ttopright.x = point.p.x;\n\t\t\t}\n\t\t\tif (point.p.y > topright.y) {\n\t\t\t\ttopright.y = point.p.y;\n\t\t\t}\n\t\t});\n\n\t\tvar padding = topright.subtract(bottomleft).multiply(0.07); // ~5% padding\n\n\t\treturn {bottomleft: bottomleft.subtract(padding), topright: topright.add(padding)};\n\t};\n\n\n\t// Vector\n\tvar Vector = Springy.Vector = function(x, y) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t};\n\n\tVector.random = function() {\n\t\treturn new Vector(10.0 * (Math.random() - 0.5), 10.0 * (Math.random() - 0.5));\n\t};\n\n\tVector.prototype.add = function(v2) {\n\t\treturn new Vector(this.x + v2.x, this.y + v2.y);\n\t};\n\n\tVector.prototype.subtract = function(v2) {\n\t\treturn new Vector(this.x - v2.x, this.y - v2.y);\n\t};\n\n\tVector.prototype.multiply = function(n) {\n\t\treturn new Vector(this.x * n, this.y * n);\n\t};\n\n\tVector.prototype.divide = function(n) {\n\t\treturn new Vector((this.x / n) || 0, (this.y / n) || 0); // Avoid divide by zero errors..\n\t};\n\n\tVector.prototype.magnitude = function() {\n\t\treturn Math.sqrt(this.x*this.x + this.y*this.y);\n\t};\n\n\tVector.prototype.normal = function() {\n\t\treturn new Vector(-this.y, this.x);\n\t};\n\n\tVector.prototype.normalise = function() {\n\t\treturn this.divide(this.magnitude());\n\t};\n\n\t// Point\n\tLayout.ForceDirected.Point = function(position, mass) {\n\t\tthis.p = position; // position\n\t\tthis.m = mass; // mass\n\t\tthis.v = new Vector(0, 0); // velocity\n\t\tthis.a = new Vector(0, 0); // acceleration\n\t};\n\n\tLayout.ForceDirected.Point.prototype.applyForce = function(force) {\n\t\tthis.a = this.a.add(force.divide(this.m));\n\t};\n\n\t// Spring\n\tLayout.ForceDirected.Spring = function(point1, point2, length, k) {\n\t\tthis.point1 = point1;\n\t\tthis.point2 = point2;\n\t\tthis.length = length; // spring length at rest\n\t\tthis.k = k; // spring constant (See Hooke's law) .. how stiff the spring is\n\t};\n\n\t// Layout.ForceDirected.Spring.prototype.distanceToPoint = function(point)\n\t// {\n\t// \t// hardcore vector arithmetic.. ohh yeah!\n\t// \t// .. see http://stackoverflow.com/questions/849211/shortest-distance-between-a-point-and-a-line-segment/865080#865080\n\t// \tvar n = this.point2.p.subtract(this.point1.p).normalise().normal();\n\t// \tvar ac = point.p.subtract(this.point1.p);\n\t// \treturn Math.abs(ac.x * n.x + ac.y * n.y);\n\t// };\n\n\t/**\n\t * Renderer handles the layout rendering loop\n\t * @param onRenderStop optional callback function that gets executed whenever rendering stops.\n\t * @param onRenderStart optional callback function that gets executed whenever rendering starts.\n\t */\n\tvar Renderer = Springy.Renderer = function(layout, clear, drawEdge, drawNode, onRenderStop, onRenderStart) {\n\t\tthis.layout = layout;\n\t\tthis.clear = clear;\n\t\tthis.drawEdge = drawEdge;\n\t\tthis.drawNode = drawNode;\n\t\tthis.onRenderStop = onRenderStop;\n\t\tthis.onRenderStart = onRenderStart;\n\n\t\tthis.layout.graph.addGraphListener(this);\n\t}\n\n\tRenderer.prototype.graphChanged = function(e) {\n\t\tthis.start();\n\t};\n\n\t/**\n\t * Starts the simulation of the layout in use.\n\t *\n\t * Note that in case the algorithm is still or already running then the layout that's in use\n\t * might silently ignore the call, and your optional <code>done</code> callback is never executed.\n\t * At least the built-in ForceDirected layout behaves in this way.\n\t *\n\t * @param done An optional callback function that gets executed when the springy algorithm stops,\n\t * either because it ended or because stop() was called.\n\t */\n\tRenderer.prototype.start = function(done) {\n\t\tvar t = this;\n\t\tthis.layout.start(function render() {\n\t\t\tt.clear();\n\n\t\t\tt.layout.eachEdge(function(edge, spring) {\n\t\t\t\tt.drawEdge(edge, spring.point1.p, spring.point2.p);\n\t\t\t});\n\n\t\t\tt.layout.eachNode(function(node, point) {\n\t\t\t\tt.drawNode(node, point.p);\n\t\t\t});\n\t\t}, this.onRenderStop, this.onRenderStart);\n\t};\n\n\tRenderer.prototype.stop = function() {\n\t\tthis.layout.stop();\n\t};\n\n\t// Array.forEach implementation for IE support..\n\t//https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/forEach\n\tif ( !Array.prototype.forEach ) {\n\t\tArray.prototype.forEach = function( callback, thisArg ) {\n\t\t\tvar T, k;\n\t\t\tif ( this == null ) {\n\t\t\t\tthrow new TypeError( \" this is null or not defined\" );\n\t\t\t}\n\t\t\tvar O = Object(this);\n\t\t\tvar len = O.length >>> 0; // Hack to convert O.length to a UInt32\n\t\t\tif ( {}.toString.call(callback) != \"[object Function]\" ) {\n\t\t\t\tthrow new TypeError( callback + \" is not a function\" );\n\t\t\t}\n\t\t\tif ( thisArg ) {\n\t\t\t\tT = thisArg;\n\t\t\t}\n\t\t\tk = 0;\n\t\t\twhile( k < len ) {\n\t\t\t\tvar kValue;\n\t\t\t\tif ( k in O ) {\n\t\t\t\t\tkValue = O[ k ];\n\t\t\t\t\tcallback.call( T, kValue, k, O );\n\t\t\t\t}\n\t\t\t\tk++;\n\t\t\t}\n\t\t};\n\t}\n\n\tvar isEmpty = function(obj) {\n\t\tfor (var k in obj) {\n\t\t\tif (obj.hasOwnProperty(k)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t};\n\n  return Springy;\n}));\n"]}